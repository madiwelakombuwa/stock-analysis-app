<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Analysis - Eight Commandments</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%233b82f6'/><text x='50' y='70' font-size='60' text-anchor='middle' fill='white' font-weight='bold' font-family='Arial'>8</text></svg>">
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.2.1/dist/chartjs-plugin-annotation.min.js"></script>
</head>
<body>
    <div class="top-nav">
        <div class="nav-container">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 32 32" style="margin-right: 8px;">
                    <rect width="32" height="32" rx="6" fill="#3b82f6"/>
                    <path d="M8 20 L12 16 L16 18 L20 12 L24 14" stroke="white" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="8" cy="20" r="1.5" fill="white"/>
                    <circle cx="12" cy="16" r="1.5" fill="white"/>
                    <circle cx="16" cy="18" r="1.5" fill="white"/>
                    <circle cx="20" cy="12" r="1.5" fill="white"/>
                    <circle cx="24" cy="14" r="1.5" fill="white"/>
                </svg>
                Stock Analysis
            </div>
            <div class="search-container">
                <input type="text" id="tickerInput" class="stock-search" placeholder="Stock search..." />
                <button id="analyzeBtn" class="search-btn">Search</button>
                <button id="downloadPdfBtn" class="pdf-btn hidden">Download PDF</button>
                <button id="settingsBtn" class="settings-btn">‚öôÔ∏è Settings</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="modal-close" id="closeSettings">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3>OpenAI API Configuration</h3>
                    <p class="settings-description">Enter your OpenAI API key to enable AI-powered insights. Your key is stored locally in your browser.</p>
                    <div class="form-group">
                        <label for="apiKeyInput">API Key</label>
                        <input type="password" id="apiKeyInput" class="form-control" placeholder="sk-proj-...">
                        <button id="toggleApiKey" class="toggle-visibility">üëÅÔ∏è Show</button>
                    </div>
                    <div class="form-actions">
                        <button id="saveApiKey" class="btn-primary">Save API Key</button>
                        <button id="clearApiKey" class="btn-secondary">Clear API Key</button>
                    </div>
                    <p class="api-status" id="apiStatus"></p>
                    <div class="settings-help">
                        <p><strong>How to get an API key:</strong></p>
                        <ol>
                            <li>Go to <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI API Keys</a></li>
                            <li>Sign in or create an account</li>
                            <li>Click "Create new secret key"</li>
                            <li>Copy the key and paste it above</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="loading" class="loading hidden">
        <div class="spinner"></div>
        <p>Loading stock data...</p>
    </div>

    <div id="error" class="error hidden"></div>

    <div id="results" class="results hidden">
        <!-- Stock Header -->
        <div class="stock-header">
            <div class="stock-header-content">
                <div class="stock-info">
                    <div class="stock-logo" id="stockLogo"></div>
                    <div class="stock-details">
                        <h1 id="stockName">Loading...</h1>
                        <p class="stock-exchange" id="stockExchange">NASDAQ - Real Time Price</p>
                    </div>
                </div>
                <div class="stock-price-info">
                    <div class="current-price" id="currentPrice">$0.00</div>
                    <div class="price-change" id="priceChange">+$0.00 (+0.00%)</div>
                    <div class="price-subtext" id="priceSubtext">After hours: 4:19PM EDT</div>
                    <div class="recommendation-badge" id="recommendationBadge">HOLD</div>
                </div>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="main-tabs">
            <button class="main-tab" data-maintab="movers">Top Movers</button>
            <button class="main-tab" data-maintab="metrics">Metrics</button>
            <button class="main-tab active" data-maintab="pillars">Eight Commandments</button>
            <button class="main-tab" data-maintab="financials">Financials</button>
            <button class="main-tab" data-maintab="analyst">Analyst Estimates</button>
            <button class="main-tab" data-maintab="ai-insights">AI Insights</button>
        </div>

        <!-- Top Gainers & Losers Tab Content -->
        <div id="moversTab" class="tab-content">
            <div class="content-container">
                <div class="movers-grid">
                    <div class="movers-section">
                        <h2 class="section-title">üöÄ Top Gainers</h2>
                        <div id="topGainers" class="movers-list">
                            <div class="movers-loading">Loading...</div>
                        </div>
                    </div>
                    <div class="movers-section">
                        <h2 class="section-title">üìâ Top Losers</h2>
                        <div id="topLosers" class="movers-list">
                            <div class="movers-loading">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Metrics Tab Content -->
        <div id="metricsTab" class="tab-content">
            <div class="content-container">
                <h2 class="section-title">Valuation Metrics</h2>
                <div id="valuationMetrics" class="metrics-table"></div>

                <h2 class="section-title">Market Data</h2>
                <div id="marketMetrics" class="metrics-table"></div>

                <h2 class="section-title">Profitability</h2>
                <div id="profitabilityMetrics" class="metrics-table"></div>

                <h2 class="section-title">Financial Health</h2>
                <div id="healthMetrics" class="metrics-table"></div>
            </div>
        </div>

        <!-- Eight Commandments Tab Content -->
        <div id="pillarsTab" class="tab-content active">
            <div class="content-container">
                <div class="pillars-header">
                    <h2>Eight Commandments <span class="pill-count" id="pillarScore">0/8</span></h2>
                    <p class="pillars-subtitle">Key metrics to evaluate stock strength</p>
                </div>
                <div id="pillarsGrid" class="pillars-grid"></div>

                <div class="metrics-summary">
                    <div class="metrics-summary-grid">
                        <div class="metrics-column">
                            <h3>Valuation Metrics</h3>
                            <div id="valuationSummary"></div>
                        </div>
                        <div class="metrics-column">
                            <h3>Income Statement</h3>
                            <div id="incomeSummary"></div>
                        </div>
                        <div class="metrics-column">
                            <h3>Balance Sheet</h3>
                            <div id="balanceSummary"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Financials Tab Content -->
        <div id="financialsTab" class="tab-content">
            <div class="content-container">
                <div class="financial-tabs">
                    <button class="fin-tab active" data-fintab="income">Income Statement</button>
                    <button class="fin-tab" data-fintab="balance">Balance Sheet</button>
                    <button class="fin-tab" data-fintab="cashflow">Cash Flow</button>
                </div>
                <div id="financialStatements" class="table-container"></div>
            </div>
        </div>

        <!-- Analyst Tab Content -->
        <div id="analystTab" class="tab-content">
            <div class="content-container">
                <h2 class="section-title">Analyst Recommendations</h2>
                <div id="analystRec" class="analyst-grid"></div>

                <h2 class="section-title">Price Targets</h2>
                <div id="priceTargets" class="metrics-table"></div>

                <h2 class="section-title">Latest News</h2>
                <div id="newsContainer" class="news-container">
                    <div class="news-loading">Loading news...</div>
                </div>
            </div>
        </div>

        <!-- AI Insights Tab Content -->
        <div id="aiInsightsTab" class="tab-content">
            <div class="content-container">
                <h2 class="section-title">AI-Powered Stock Analysis</h2>
                <div id="aiInsightsContent" class="ai-insights-content">
                    <div class="ai-loading">
                        <div class="spinner"></div>
                        <p>Analyzing stock data with AI...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stock Chart Section -->
        <div class="chart-section">
            <div class="content-container">
                <h2 class="section-title" id="chartTitle">Price History (1 Year)</h2>
                <canvas id="priceChart"></canvas>
            </div>
        </div>
    </div>

    <script src="/js/app.js"></script>
</body>
</html>
